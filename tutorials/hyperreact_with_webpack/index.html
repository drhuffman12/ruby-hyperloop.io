<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv='X-UA-Compatible' content='IE=edge;chrome=1' />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <meta name="google-site-verification" content="qjqVOvRhHfsuDbLOvaAnj2mkUZJ9Xwzg84TMVXduvUc" />

    <meta charset="UTF-8">
    <title>Hyperloop</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>

    <!-- <link href="/stylesheets/base.css" rel="stylesheet" />
    <link href="/stylesheets/normalize.css" rel="stylesheet" />
    <link href="/stylesheets/stylesheet.css" rel="stylesheet" />
    <link href="/stylesheets/github-light.css" rel="stylesheet" /> -->

    <link href="/stylesheets/bootstrap.min.css" rel="stylesheet" />
    <link href="/stylesheets/override.css" rel="stylesheet" />
    <link href="/stylesheets/code.css" rel="stylesheet" />

    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />

    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="57x57" href="/images/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/images/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/images/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/images/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/images/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/images/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/images/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/images/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/images/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/images/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

  </head>

  <body>
    <div class="container">
      <nav class="navbar navbar-ligh">
  <button class="navbar-toggler hidden-sm-up" type="button" data-toggle="collapse" data-target="#exCollapsingNavbar2" aria-controls="exCollapsingNavbar2" aria-expanded="false" aria-label="Toggle navigation">
    &#9776;
  </button>
  <div class="collapse navbar-toggleable-xs" id="exCollapsingNavbar2">
    <ul class="nav navbar-nav">
      <li class="nav-item">
        <a href="/" class="nav-link">Hyperloop</a>
      </li>
      <li class="nav-item">
        <a href="/get_started" class="nav-link active">Get Started</a>
      </li>
      <li class="nav-item">
        <a href="/tutorials" class="nav-link">Tutorials</a>
      </li>
      <li class="nav-item">
        <a href="/installation" class="nav-link">Installation</a>
      </li>
      <li class="nav-item">
        <a href="/gems" class="nav-link">Gems</a>
      </li>
      <li class="nav-item">
        <a href="https://github.com/ruby-hyperloop" class="nav-link">Github</a>
      </li>
      <li class="nav-item">
        <a href="/tools" class="nav-link">Tools</a>
      </li>
      <li class="nav-item">
        <a href="/docs/dsl_overview" class="nav-link">Docs</a>
      </li>
      <li class="nav-item">
        <a href="/support" class="nav-link">Support</a>
      </li>
      <li class="nav-item">
        <a href="/blog" class="nav-link">Blog</a>
      </li>
    </ul>
  </div>
</nav>

    </div>

    <div class="jumbotron page-header">
      <div class="container">
        <div class="row hidden-xs-down">
          <div class="col-md-3 center-text">
            <img src="/images/hyperloop_white.svg" width="180" alt="Hyperloop white" />
          </div>
          <div class="col-md-9">
            <h1 class="display-4 project-name">Hyperloop</h1>
            </br>
            <h2 class="display-7 project-tagline">
              THE MISSING RUBY FRONT-END LIBRARY
            </h2>
          </div>
        </div>
        <div class="row hidden-sm-up">
          <div class="col-md-3 center-text">
            <img src="/images/hyperloop_white.svg" width="120" alt="Hyperloop white" />
          </div>
          <div class="col-md-9">
            <h1 class="h1 project-name center-text">Hyperloop</h1>
            </br>
            <h2 class="h4 project-tagline center-text">
              THE MISSING RUBY FRONT-END LIBRARY
            </h2>
          </div>
        </div>
      </div>
    </div>

    <div class="container">
      <div class="row">
        <div class="col-md-3">
            <ul class="nav">
    <li class="nav-item"><strong><a href="/tutorials/chat_app">Chat-App Tutorial</a></strong></li>
    <ul class="nav">
      <li class="nav-item"><a href="/tutorials/chat_app#application-structure">Application Structure</a></li>
      <li class="nav-item"><a href="/tutorials/chat_app#adding-parameters">Adding Parameters</a></li>
      <li class="nav-item"><a href="/tutorials/chat_app#adding-an-event-handler">Adding An Event Handler</a></li>
      <li class="nav-item"><a href="/tutorials/chat_app#adding-state">Adding State</a></li>
      <li class="nav-item"><a href="/tutorials/chat_app#talking-to-your-parents">Talking to Your Parents</a></li>
      <li class="nav-item"><a href="/tutorials/chat_app#lifecycle-callbacks">Lifecycle Callbacks</a></li>
      <li class="nav-item"><a href="/tutorials/chat_app#instance-and-state-variables">Instance and State Variables</a></li>
      <li class="nav-item"><a href="/tutorials/chat_app#sending-messages">Sending Messages</a></li>
      <li class="nav-item"><a href="/tutorials/chat_app#styling-the-app">Styling the App</a></li>
      <li class="nav-item"><a href="/tutorials/chat_app#source-code-of-the-steps-up-until-detecting-loged-in-user">Source Code</a></li>
    </ul>
  </br>
    <li class="nav-item"><strong><a href="/tutorials/hyperreact_with_rails">HyperReact and Rails Tutorial</a></strong></li>
    <ul class="nav">
      <li class="nav-item"><a href="/tutorials/hyperreact_with_rails#using-hyperrails">Using HyperRails</a></li>
      <li class="nav-item"><a href="/tutorials/hyperreact_with_rails#adding-a-component">Adding a component</a></li>
      <li class="nav-item"><a href="/tutorials/hyperreact_with_rails#controller-rendering">Controller Rendering</a></li>
    </ul>
  </br>
    <li class="nav-item"><strong><a href="/tutorials/hyperreact_with_webpack">NPM and Webpack Tutorial</a></strong></li>
    <ul class="nav">
      <li class="nav-item"><a href="/tutorials/hyperreact_with_webpack#setup">Setup</a></li>
      <li class="nav-item"><a href="/tutorials/hyperreact_with_webpack#usage">Usage</a></li>
      <li class="nav-item"><a href="/tutorials/hyperreact_with_webpack#example">Example</a></li>
    </ul>
  </br>
    <li class="nav-item"><strong><a href="/tutorials/flux_store">Flux Store Tutorial</a></strong></li>
  </br>
  </ul>


          <br>
        </div>
        <div class="col-md-9 main-content">
          <h1 id="hyperreact-npm-and-webpack">HyperReact, NPM and Webpack</h1>

<h2 id="overview-and-prerequisites">Overview and prerequisites</h2>

<p>In an Isomorphic Ruby world, we need a good way of including Ruby and JavaScript components so they co-exist and play nicely together.</p>

<p>Most Ruby libraries are distributed as Gems whereas (these days) most Javascript components are distributed through NPM. Webpack co-exists well with Rails and the combination of Rails, Yarn, Sprockets and Webpack looks like it might become a standard within the Rails community.</p>

<p>This tutorial will take you through <a href="#setup">Setup</a> of NPM and Webpack, <a href="#usage">Usage</a> instructions for adding new components and then give an <a href="#example">Example</a> of adding and using a JavaScript component in a HyperReact project.</p>

<p>This tutorial assumes that NPM is installed. Please see the <a href="https://www.npmjs.com/">NPM website</a> for installation instructions.</p>

<p>Additionally, this tutorial starts with an existing Rails app with <strong>HyperReact already setup and working</strong>. For more information on how to get to that stage, please see the <a href="http://ruby-hyperloop.io/tutorials/hyperreact_with_rails/">HyperReact and Rails Tutorial</a>.</p>

<p>The source of this tutorial is avaiable as a <a href="https://github.com/ruby-hyperloop/quickstart">Quickstart</a> which you can clone.</p>

<h2 id="setup">Setup</h2>

<p>If you have completed the prerequisites above, let&rsquo;s get started - there are 5 steps to this process:</p>

<ol>
<li>Adding Webpack to your Rails project</li>
<li>Setting up Webpack</li>
<li>Using Webpack to build your client and server bundles</li>
<li>Installing React and ReactDOM via NPM</li>
<li>Adding Webpack bundles to the Rails asset pipeline</li>
</ol>

<h3 id="step-1-adding-webpack-to-your-rails-project">Step 1 - Adding Webpack to your Rails project</h3>

<p>Run these three commands:</p>

<p><code>npm init</code> will create an empty package.json in your root folder</p>

<p><code>npm install webpack --save-dev</code> install Webpack and create a node_modules folder</p>

<p><code>npm install webpack -g</code> so we can run Webpack from the command line</p>

<p>The commands above will have created a <code>package.json</code> (similar concept to a Gemfile) and a <code>node_modules</code> folder containing hundreds of JavaScript dependancies that we do not need in the source of our project so let&rsquo;s tell git to ignore them by adding a <code>.gitignore</code> file:</p>
<pre class="highlight plaintext"><code>#/.gitignore
/node_modules
</code></pre>
<h3 id="step-2-setting-up-webpack">Step 2 - Setting up Webpack</h3>

<p>Now that we have Webpack, we need to add 3 boiler plate files to configure it. As you add more JavaScript packages you will be updating these files. Again this is similar to updating your Gemfile when you add new gems to a project.</p>

<p>Add <code>webpack.config.js</code> to the root of your project:</p>
<pre class="highlight javascript"><code><span class="c1">// webpack.config.js</span>
<span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"path"</span><span class="p">);</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">context</span><span class="p">:</span> <span class="nx">__dirname</span><span class="p">,</span>
    <span class="na">entry</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">client_only</span><span class="p">:</span>  <span class="s2">"./webpack/client_only.js"</span><span class="p">,</span>
      <span class="na">client_and_server</span><span class="p">:</span> <span class="s2">"./webpack/client_and_server.js"</span>
    <span class="p">},</span>
    <span class="na">output</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">path</span><span class="p">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s1">'app'</span><span class="p">,</span> <span class="s1">'assets'</span><span class="p">,</span>   <span class="s1">'javascripts'</span><span class="p">,</span> <span class="s1">'webpack'</span><span class="p">),</span>
      <span class="na">filename</span><span class="p">:</span> <span class="s2">"[name].js"</span><span class="p">,</span>
      <span class="na">publicPath</span><span class="p">:</span> <span class="s2">"/webpack/"</span>
    <span class="p">},</span>
    <span class="na">module</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">loaders</span><span class="p">:</span> <span class="p">[</span>
        <span class="c1">// add any loaders here</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="na">resolve</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">root</span><span class="p">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s1">'..'</span><span class="p">,</span> <span class="s1">'webpack'</span><span class="p">)</span>
    <span class="p">},</span>
<span class="p">};</span>
</code></pre>
<p>Then create a folder called webpack and add the following two files:</p>
<pre class="highlight javascript"><code><span class="c1">// webpack/client_only.js</span>
<span class="c1">// any packages that depend specifically on the DOM go here</span>
<span class="c1">// for example the webpack css loader generates code that will break prerendering</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'client_only.js loaded'</span><span class="p">);</span>
</code></pre><pre class="highlight javascript"><code><span class="c1">// webpack/client_and_server.js</span>
<span class="c1">// all other packages that you can run on both server (prerendering) and client go here</span>
<span class="c1">// most well behaved packages can be required here</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'client_and_server.js loaded'</span><span class="p">)</span>
</code></pre>
<h3 id="step-3-using-webpack-to-build-your-client-and-server-bundles">Step 3 - Using Webpack to build your client and server bundles</h3>

<p>Simply run this command:</p>

<p><code>webpack</code></p>

<p>You should see a result something like this:</p>
<pre class="highlight plaintext"><code>Hash: 756a1dc4a11c8fccd0a4
Version: webpack 1.14.0
Time: 55ms
               Asset     Size  Chunks             Chunk Names
client_and_server.js  1.61 kB       0  [emitted]  client_and_server
      client_only.js  1.61 kB       1  [emitted]  client_only
   [0] ./webpack/client_and_server.js 214 bytes {0} [built]
   [0] ./webpack/client_only.js 206 bytes {1} [built]```
</code></pre>
<p>Our <code>client_and_server.js</code> and <code>client_only.js</code> bundles are built and ready to be included in our application. If you look in your <code>app/assets/javascripts/webpack</code> folder you should see the two files there. Note that these bundles are empty at the moment as we have not added any JavaScript components yet. We will do that in Step 6.</p>

<h3 id="step-4-adding-webpack-bundles-to-the-rails-asset-pipeline">Step 4 - Adding Webpack bundles to the Rails asset pipeline</h3>

<p>Finally we need to require these two bundles into our rails asset pipeline.</p>

<p>Edit <code>app/assets/javascripts/application.js</code> and add</p>
<pre class="highlight ruby"><code><span class="sr">//</span><span class="o">=</span> <span class="nb">require</span> <span class="s1">'webpack/client_only'</span>
</code></pre>
<p>Then edit <code>app/views/components.rb</code> and directly after <code>require &#39;hyper-react&#39;</code> add the following two lines:</p>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'webpack/client_and_server.js'</span>
<span class="nb">require</span> <span class="s1">'reactrb/auto-import'</span>
</code></pre>
<h3 id="step-5-installing-react-and-reactdom">Step 5 - Installing React and ReactDOM</h3>

<p>This step is really simple as we have NPM installed. Just run these two commands:</p>

<p><code>npm install react --save</code> to install React
<code>npm install react-dom --save</code> to install ReactDOM</p>

<p>Note how this modifies your &lsquo;package.json&rsquo; and installs React and ReactDOM in your <code>node_modules</code> folder.</p>

<p>Next we need to <code>require</code> them into <code>client_and_server.js</code>:</p>
<pre class="highlight javascript"><code><span class="c1">// webpack/client_and_server.js</span>
<span class="nx">ReactDOM</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'react-dom'</span><span class="p">)</span>
<span class="nx">React</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'react'</span><span class="p">)</span>
</code></pre>
<p>And finally we need to run <code>webpack</code> to add them to the bundle:</p>
<pre class="highlight plaintext"><code>webpack
</code></pre>
<p>The output should look something like this:</p>
<pre class="highlight plaintext"><code>Hash: db338e21dcc44f66e5b5
Version: webpack 1.14.0
Time: 737ms
               Asset     Size  Chunks             Chunk Names
client_and_server.js   740 kB       0  [emitted]  client_and_server
      client_only.js  1.61 kB       1  [emitted]  client_only
   [0] ./webpack/client_and_server.js 271 bytes {0} [built]
   [0] ./webpack/client_only.js 206 bytes {1} [built]
    + 177 hidden modules
</code></pre>
<p>Note that <code>client_and_server.js</code> has gone from 1.61kB to 740kB as it now includes the source of React and ReactDOM.</p>

<h2 id="usage">Usage</h2>

<p>Now that we have completed the setup, using NPM and Webpack to include new JavaScript components is simply a case of running Step 6 again for each component you would like to add. You simply follow these three steps:</p>

<ol>
<li>Install the component using NPM <code>npm install xx --save</code></li>
<li><code>require</code> the component into either <code>webpack/client_and_server.js</code> or <code>webpack/client_only.js</code></li>
<li>Run the <code>webpack</code> command to rebuild your bundles</li>
</ol>

<p>Adding a components via NPM and then making it accessible to HyperReact as a Ruby class really is that simple.</p>

<h2 id="example">Example</h2>

<p>To complete this tutorial, let&rsquo;s install a JavaScript React component and use it in HyperReact.</p>

<p>We are going to use <a href="https://github.com/CookPete/playr">Pete Cook’s React rplayr</a> to play a YouTube video.</p>

<p>First let’s install the component via NPM:</p>
<pre class="highlight plaintext"><code>npm install react-player --save
</code></pre>
<p>Next we need to <code>require</code> it in <code>webpack/client_and_server.js</code></p>
<pre class="highlight javascript"><code><span class="c1">// webpack/client_and_server.js</span>
<span class="nx">ReactPlayer</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'react-player'</span><span class="p">)</span>
</code></pre>
<p>Then run <code>webpack</code> so it can be bundled</p>
<pre class="highlight plaintext"><code>webpack
</code></pre>
<p>And then finally let’s use it while rendering a HyperReact component:</p>
<pre class="highlight ruby"><code><span class="k">def</span> <span class="nf">render</span>
  <span class="n">div</span> <span class="k">do</span>
    <span class="no">ReactPlayer</span><span class="p">(</span><span class="ss">url:  </span><span class="s1">'https://www.youtube.com/embed/FzCsDVfPQqk'</span><span class="p">,</span>
      <span class="ss">playing: </span><span class="kp">true</span>
    <span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
        </div>
      </div>
    </div>


    <script   src="http://code.jquery.com/jquery-3.1.1.min.js"   integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="   crossorigin="anonymous"></script>
    <script src="/javascripts/bootstrap.min.js"></script>

  </body>
</html>
